<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>判断是搜索还是网址 | Jay&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/codecat.jpeg">
    <meta name="description" content="贾一倍的个人网站">
    
    <link rel="preload" href="/assets/css/0.styles.35bcedcf.css" as="style"><link rel="preload" href="/assets/js/app.ffeb74c7.js" as="script"><link rel="preload" href="/assets/js/2.8c000b42.js" as="script"><link rel="preload" href="/assets/js/16.81145a00.js" as="script"><link rel="prefetch" href="/assets/js/10.d264db59.js"><link rel="prefetch" href="/assets/js/11.0bca9d9a.js"><link rel="prefetch" href="/assets/js/12.4f250ebe.js"><link rel="prefetch" href="/assets/js/13.e66cb20f.js"><link rel="prefetch" href="/assets/js/14.e9740e5f.js"><link rel="prefetch" href="/assets/js/15.77f24c1c.js"><link rel="prefetch" href="/assets/js/17.fecbbc6a.js"><link rel="prefetch" href="/assets/js/18.fa64136a.js"><link rel="prefetch" href="/assets/js/19.0bf73149.js"><link rel="prefetch" href="/assets/js/20.ecf66ee0.js"><link rel="prefetch" href="/assets/js/21.9b56c347.js"><link rel="prefetch" href="/assets/js/22.eba330b8.js"><link rel="prefetch" href="/assets/js/23.cdfc8136.js"><link rel="prefetch" href="/assets/js/24.ecbff0b4.js"><link rel="prefetch" href="/assets/js/25.a765f52f.js"><link rel="prefetch" href="/assets/js/26.1df3f3be.js"><link rel="prefetch" href="/assets/js/27.6d559f57.js"><link rel="prefetch" href="/assets/js/28.44d0a27d.js"><link rel="prefetch" href="/assets/js/29.0db53b84.js"><link rel="prefetch" href="/assets/js/3.593bb0f3.js"><link rel="prefetch" href="/assets/js/30.ecd999ba.js"><link rel="prefetch" href="/assets/js/31.52600e5f.js"><link rel="prefetch" href="/assets/js/32.32943b2d.js"><link rel="prefetch" href="/assets/js/33.362f4d59.js"><link rel="prefetch" href="/assets/js/34.d0944a8e.js"><link rel="prefetch" href="/assets/js/35.bf1908ad.js"><link rel="prefetch" href="/assets/js/36.2d9be9dc.js"><link rel="prefetch" href="/assets/js/37.3358ac3c.js"><link rel="prefetch" href="/assets/js/38.bae9ecf2.js"><link rel="prefetch" href="/assets/js/39.dfcb747a.js"><link rel="prefetch" href="/assets/js/4.01f7dd6c.js"><link rel="prefetch" href="/assets/js/40.dbf6c454.js"><link rel="prefetch" href="/assets/js/41.a517905d.js"><link rel="prefetch" href="/assets/js/42.e1ae6c7e.js"><link rel="prefetch" href="/assets/js/43.c20697cd.js"><link rel="prefetch" href="/assets/js/44.d5c401fa.js"><link rel="prefetch" href="/assets/js/45.810ad2fb.js"><link rel="prefetch" href="/assets/js/46.cfe99c5e.js"><link rel="prefetch" href="/assets/js/47.32a6c154.js"><link rel="prefetch" href="/assets/js/48.be512d65.js"><link rel="prefetch" href="/assets/js/49.d36d3e6d.js"><link rel="prefetch" href="/assets/js/5.eb23ea04.js"><link rel="prefetch" href="/assets/js/50.4312a7d3.js"><link rel="prefetch" href="/assets/js/51.8db2277f.js"><link rel="prefetch" href="/assets/js/52.0ae05eb4.js"><link rel="prefetch" href="/assets/js/53.e61fc25e.js"><link rel="prefetch" href="/assets/js/54.0f5b381c.js"><link rel="prefetch" href="/assets/js/55.c7beb55c.js"><link rel="prefetch" href="/assets/js/56.97fa88fd.js"><link rel="prefetch" href="/assets/js/57.1e086f28.js"><link rel="prefetch" href="/assets/js/58.97111a0a.js"><link rel="prefetch" href="/assets/js/59.8865259a.js"><link rel="prefetch" href="/assets/js/6.516e3b20.js"><link rel="prefetch" href="/assets/js/60.0541b26f.js"><link rel="prefetch" href="/assets/js/61.624fbdfa.js"><link rel="prefetch" href="/assets/js/62.e71bbf4a.js"><link rel="prefetch" href="/assets/js/63.ad78749d.js"><link rel="prefetch" href="/assets/js/64.931d419d.js"><link rel="prefetch" href="/assets/js/65.b46213b4.js"><link rel="prefetch" href="/assets/js/66.92c8d024.js"><link rel="prefetch" href="/assets/js/67.c63280ef.js"><link rel="prefetch" href="/assets/js/68.16012c5b.js"><link rel="prefetch" href="/assets/js/69.b4a8ea96.js"><link rel="prefetch" href="/assets/js/7.c7625e6b.js"><link rel="prefetch" href="/assets/js/70.c03c3735.js"><link rel="prefetch" href="/assets/js/71.76491655.js"><link rel="prefetch" href="/assets/js/72.ab24e160.js"><link rel="prefetch" href="/assets/js/73.9026af07.js"><link rel="prefetch" href="/assets/js/74.8f925ea4.js"><link rel="prefetch" href="/assets/js/75.8c3d4d08.js"><link rel="prefetch" href="/assets/js/76.2e25789c.js"><link rel="prefetch" href="/assets/js/77.bc9764be.js"><link rel="prefetch" href="/assets/js/78.d13a2495.js"><link rel="prefetch" href="/assets/js/8.80450da7.js"><link rel="prefetch" href="/assets/js/9.dd8d6c7c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.35bcedcf.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Jay's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/accumulate/" class="nav-link router-link-active">
  前端基础
</a></div><div class="nav-item"><a href="/stack/" class="nav-link">
  技术栈
</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">
  算法题库
</a></div><div class="nav-item"><a href="/browser/" class="nav-link">
  浏览器
</a></div><div class="nav-item"><a href="/network/" class="nav-link">
  计算机网络
</a></div><div class="nav-item"><a href="/optimize/" class="nav-link">
  优化
</a></div><div class="nav-item"><a href="/c++/" class="nav-link">
  c++
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/accumulate/" class="nav-link router-link-active">
  前端基础
</a></div><div class="nav-item"><a href="/stack/" class="nav-link">
  技术栈
</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">
  算法题库
</a></div><div class="nav-item"><a href="/browser/" class="nav-link">
  浏览器
</a></div><div class="nav-item"><a href="/network/" class="nav-link">
  计算机网络
</a></div><div class="nav-item"><a href="/optimize/" class="nav-link">
  优化
</a></div><div class="nav-item"><a href="/c++/" class="nav-link">
  c++
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Accumulate</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/accumulate/" aria-current="page" class="sidebar-link">前端基础</a></li><li><a href="/accumulate/CSS.html" class="sidebar-link">块、行内和行内块</a></li><li><a href="/accumulate/H5离线缓存.html" class="sidebar-link">H5离线缓存（应用程序缓存）Deprecated</a></li><li><a href="/accumulate/JS.html" class="sidebar-link">lodash</a></li><li><a href="/accumulate/JS手写.html" class="sidebar-link">new、call、apply实现</a></li><li><a href="/accumulate/Node.html" class="sidebar-link">Node</a></li><li><a href="/accumulate/Typescript.html" class="sidebar-link">基础类型</a></li><li><a href="/accumulate/URL到页面.html" class="active sidebar-link">判断是搜索还是网址</a></li><li><a href="/accumulate/VScode.html" class="sidebar-link">eslint</a></li><li><a href="/accumulate/canvas和svg.html" class="sidebar-link">canvas</a></li><li><a href="/accumulate/electron.html" class="sidebar-link">app</a></li><li><a href="/accumulate/meta标签.html" class="sidebar-link">meta</a></li><li><a href="/accumulate/位运算.html" class="sidebar-link">有符号整数和无符号整数</a></li><li><a href="/accumulate/你不知道的Javascript上.html" class="sidebar-link">1作用域是什么</a></li><li><a href="/accumulate/你不知道的Javascript中.html" class="sidebar-link">1类型</a></li><li><a href="/accumulate/创建对象和对象继承.html" class="sidebar-link">创建对象方式：</a></li><li><a href="/accumulate/初识webpack.html" class="sidebar-link">webpack</a></li><li><a href="/accumulate/前端路由.html" class="sidebar-link">参考《SPA 路由三部曲之核心原理》</a></li><li><a href="/accumulate/动画.html" class="sidebar-link">GIF</a></li><li><a href="/accumulate/垃圾回收机制.html" class="sidebar-link">garbage collection</a></li><li><a href="/accumulate/新词.html" class="sidebar-link">这个文档用来记录一些新鲜词汇</a></li><li><a href="/accumulate/模块化.html" class="sidebar-link">commonJS</a></li><li><a href="/accumulate/正则表达式.html" class="sidebar-link">Regular Expression</a></li><li><a href="/accumulate/虚拟列表.html" class="sidebar-link">虚拟列表</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h6 id="判断是搜索还是网址"><a href="#判断是搜索还是网址" class="header-anchor">#</a> 判断是搜索还是网址</h6> <p>如果是搜索内容，将搜索内容和默认搜索引擎合成新的url，如果符合url规则，根据URL协议，在输入内容上加上协议组成合法的url</p> <h6 id="检查缓存"><a href="#检查缓存" class="header-anchor">#</a> 检查缓存</h6> <ul><li>强缓存：命中就直接从内存或硬盘里拿到资源，否则进行协商缓存</li> <li>协商缓存：发送请求确认资源是否过期，304就直接获取，已过期就重新发起请求</li></ul> <h6 id="dns解析"><a href="#dns解析" class="header-anchor">#</a> DNS解析</h6> <ol><li>递归和迭代查询</li> <li>多级缓存：浏览器缓存，操作系统缓存，路由器缓存，IPS服务器缓存，根域名服务器缓存，顶级域名服务器缓存，权威域名服务器缓存</li> <li>负载均衡</li></ol> <h6 id="发起tcp连接"><a href="#发起tcp连接" class="header-anchor">#</a> 发起TCP连接</h6> <ol><li>三次握手</li></ol> <h6 id="https需要进行tls四次握手"><a href="#https需要进行tls四次握手" class="header-anchor">#</a> https需要进行TLS四次握手</h6> <h6 id="发送http请求"><a href="#发送http请求" class="header-anchor">#</a> 发送HTTP请求</h6> <ol><li>请求行    eg: GET index.html HTTP/1.1</li> <li>请求报头</li> <li>空行</li> <li>请求正文</li></ol> <h6 id="服务器处理请求并返回http报文"><a href="#服务器处理请求并返回http报文" class="header-anchor">#</a> 服务器处理请求并返回HTTP报文</h6> <ol><li>响应行</li> <li>响应报头</li> <li>空行</li> <li>响应正文</li></ol> <h6 id="浏览器解析渲染页面"><a href="#浏览器解析渲染页面" class="header-anchor">#</a> 浏览器解析渲染页面</h6> <p><a href="https://imgtu.com/i/Lwi3kt" target="_blank" rel="noopener noreferrer"><img src="https://s1.ax1x.com/2022/04/18/Lwi3kt.jpg" alt="Lwi3kt.jpg"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ol><li><p>解析HTML形成DOM树</p> <p><a href="https://imgtu.com/i/LYPQbT" target="_blank" rel="noopener noreferrer"><img src="https://s1.ax1x.com/2022/04/16/LYPQbT.png" alt="LYPQbT.png"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ul><li><p>Bytes（字节） -&gt; Character（字符） -&gt; Tokens（词）-&gt; Nodes（节点）-&gt; DOM（DOM树）</p> <p>① 通过指定编码（http响应头部Content-Type: text/html;charset=UTF-8，html文件中的meta标签中指定charset=&quot;UTF-8&quot;）将字节转化为字符</p> <p>② 通过词法分析，将字符串解析成有语义的标签、属性、文本等</p> <p>③ 根据token创建节点对象</p> <p>④ 将各节点根据父子关系构建成DOM树</p></li></ul></li> <li><p>解析CSS（从右向左，先子节点）形成CSSOM 树</p> <ul><li>节点样式可以继承，所以通常要递归DOM树来得到节点样式，所以DOM树要小，css尽量用id或class选择器，少用标签选择器</li></ul></li> <li><p>JS解析（同步和异步 async和defer）</p></li> <li><p>DOM解析</p></li> <li><p>合并DOM树和CSSOM树形成渲染树</p> <ul><li>渲染树并不是等到DOM树和CSSOM树构建完成才开始</li></ul></li> <li><p><strong>浏览器开始渲染并绘制页面</strong></p> <ul><li>对元素进行定位布局layout
<ul><li>分层：脱离文档流的元素会形成一个<strong>层叠上下文</strong>，被提升为单独的图层，然后主线程为每个图层计算样式，<strong>把每一个图层的绘制拆分成很多小的绘制指令，生成绘制表</strong>，这个表记录了绘制的顺序和绘制指令</li> <li><strong>合成器线程</strong>将图层分块，交给<strong>栅格化线程</strong>，合成器线程会收集栅格化线程的图块信息，生成一个<strong>合成器帧</strong>，浏览器进程再将合成器帧绘制到显存中，再通过 GPU 渲染在屏幕上</li> <li>栅格化线程栅格化每个图块，再将栅格化之后的图块存储在<code>GPU内存</code>中</li></ul></li> <li>绘制元素的样式</li></ul></li></ol> <ul><li><p>回流reflow 重绘repaint：重排和重绘都是运行在主线程上，而JS也是在主线程上执行，就会出现抢占执行时间的问题，而transform实现的动画直接运行在合成器线程和栅格化线程中，不会受到主线程JS执行的影响，也就不会存在动画卡帧的现象</p></li> <li><p>HTML解析器和CSS解析器是并行执行的，但link引入的css会阻塞浏览器渲染和后面js语句的执行</p> <ul><li>js会阻塞后续DOM解析、页面渲染、后续js的执行</li></ul></li> <li><p>回流重绘优化：</p> <ul><li><p>避免使用table布局。</p></li> <li><p>尽可能在DOM树的最末端改变class。</p></li> <li><p>避免设置多层内联样式。</p></li> <li><p>将动画效果应用到position属性为absolute或fixed的元素上。</p></li> <li><p>避免使用CSS表达式（例如：calc()）</p></li> <li><p>避免频繁操作样式，最好一次性重写style属性，或者将样式列表定义为class并一次性更改class属性。</p></li> <li><p>避免频繁操作DOM，创建一个documentFragment，在它上面应用所有DOM操作，最后再把它添加到文档中。</p></li> <li><p>也可以先为元素设置display: none，操作结束后再把它显示出来。因为在display属性为none的元素上进行的DOM操作不会引发回流和重绘。</p></li> <li><p>避免频繁读取会引发回流/重绘的属性，如果确实需要多次使用，就用一个变量缓存起来。</p></li> <li><p>对具有复杂动画的元素使用绝对定位，使它脱离文档流，否则会引起父元素及后续元素频繁回流</p></li></ul></li></ul> <h6 id="连接结束"><a href="#连接结束" class="header-anchor">#</a> 连接结束</h6> <ol><li>四次挥手</li></ol> <h6 id="从浏览器的角度"><a href="#从浏览器的角度" class="header-anchor">#</a> 从浏览器的角度</h6> <p>从浏览器输入 <code>URL</code> 到页面渲染的整个过程都是由 浏览器架构中的各个进程之间的配合完成</p> <p>进程：CPU资源分配的最小单位</p> <p>线程：CPU调度的最小单位</p> <p><a href="https://imgtu.com/i/Oaogmt" target="_blank" rel="noopener noreferrer"><img src="https://s1.ax1x.com/2022/05/11/Oaogmt.jpg" alt="Oaogmt.jpg"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>因为浏览器是多进程的</p> <ul><li>浏览器主进程: 管理子进程、提供服务功能</li> <li><strong>渲染进程</strong>：即<strong>浏览器内核</strong>，内部多线程；为每一个tab页面创建一个渲染进程，互不影响；主要作用是页面渲染、脚本执行和事件处理</li> <li>GPU进程：本来是负责处理3Dcss的，后来慢慢的UI界面也交给GPU来绘制</li> <li>网络进程：就是负责网络请求，网络资源加载的进程</li> <li>插件进程：负责插件的运行的，因为插件很容易崩溃，把它放到独立的进程里不要让它影响别人</li></ul> <hr> <p>渲染进程的主要线程</p> <ul><li>GUI渲染线程
<ul><li>负责渲染浏览器界面，解析HTML和CSS，构建DOM Tree和CSSOM并生成Render Tree，<strong>回流和重绘</strong></li> <li>与JS引擎线程互斥，当渲染过程中遇到script标签，渲染进程被挂起，JS引擎线程开始工作，执行完毕后，渲染线程继续渲染</li></ul></li> <li>JS引擎线程
<ul><li>即JS内核，执行JS脚本，与GUI渲染线程互斥</li></ul></li> <li>事件触发线程
<ul><li>控制事件循环，管理任务队列（task queue）</li> <li>当JS执行中遇到了异步操作或事件绑定，事件触发线程会将对应的事件添加到对应的线程（定时器操事件添加到定时器触发线程，异步请求事件添加到异步请求线程），当事件结束，将回调函数添加到任务队列中等待JS引擎线程执行</li></ul></li> <li>定时器触发线程
<ul><li><code>setInterval</code> 与 <code>setTimeout</code> 所在线程</li></ul></li> <li>异步http请求线程
<ul><li>当执行一个异步请求时，把异步请求事件添加到异步请求线程，等收到响应，就将回调函数添加到任务队列</li></ul></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/accumulate/Typescript.html" class="prev">
        基础类型
      </a></span> <span class="next"><a href="/accumulate/VScode.html">
        eslint
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.ffeb74c7.js" defer></script><script src="/assets/js/2.8c000b42.js" defer></script><script src="/assets/js/16.81145a00.js" defer></script>
  </body>
</html>
